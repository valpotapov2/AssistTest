<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>API Test ‚Äî Medical Domain</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600&family=Unbounded:wght@400;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="frontend/style.css">
</head>
<body>

<!-- TOP BAR -->
<div class="topbar">
  <div class="topbar-logo">‚öï API Test</div>
  <div class="topbar-sep"></div>
  <div class="topbar-status">
    <div class="status-dot" id="runStatusDot"></div>
    <span id="runStatusText">–ì–æ—Ç–æ–≤</span>
  </div>
  <div class="topbar-sep"></div>
  <span style="color:var(--text3);font-size:10px;">BASE URL</span>
  <input class="cfg-field" id="cfgBaseUrl" placeholder="https://geoblinker.ru/taxi/c/Assist/api/v1" value="https://geoblinker.ru/taxi/c/Assist/api/v1">
  <div class="topbar-sep"></div>
  <span style="color:var(--text3);font-size:10px;">LOGIN</span>
  <input class="cfg-field" id="cfgLogin" style="width:160px" placeholder="doctor@clinic.ru" value="doctor@doctor.ru">
  <span style="color:var(--text3);font-size:10px;">PASS</span>
  <input class="cfg-field" id="cfgPassword" style="width:130px" type="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" value="093588059">
  <div class="topbar-sep"></div>
  <div class="topbar-sep"></div>
  <button class="btn small" onclick="login()">–í–æ–π—Ç–∏</button>
  <button class="btn small" onclick="logout()">–í—ã–π—Ç–∏</button>
  <button class="btn small" onclick="loadSuites()">–ó–∞–≥—Ä—É–∑–∏—Ç—å</button>
  <button class="btn small panel-toggle-btn active" data-panel="1" onclick="togglePanel(1)">1</button>
  <button class="btn small panel-toggle-btn active" data-panel="2" onclick="togglePanel(2)">2</button>
  <button class="btn small panel-toggle-btn active" data-panel="3" onclick="togglePanel(3)">3</button>
  <button class="btn small panel-toggle-btn active" data-panel="4" onclick="togglePanel(4)">4</button>
  <div class="theme-toggle" onclick="toggleTheme()" title="–°–º–µ–Ω–∏—Ç—å —Ç–µ–º—É">
    <span class="theme-toggle-icon" id="themeIcon">üåô</span>
    <div class="theme-toggle-track"><div class="theme-toggle-thumb"></div></div>
    <span class="theme-toggle-icon" id="themeIconRight">‚òÄÔ∏è</span>
  </div>
</div>

<!-- WORKSPACE -->
<div class="workspace">

  <!-- PANEL 1: TREE -->
  <div class="panel" id="panel1">
    <div class="panel-header">
      <div class="panel-title">–ù–∞–±–æ—Ä—ã / –ö–µ–π—Å—ã</div>
      <button class="btn small" onclick="newSuite()" style="margin-left:auto" title="–ù–æ–≤—ã–π –Ω–∞–±–æ—Ä">Ôºã</button>
    </div>
    <div class="panel-body" id="suiteTree"></div>
    <div class="run-progress" id="runProgress">
      <div class="progress-bar-track"><div class="progress-bar-fill" id="progressFill"></div></div>
      <div class="progress-stats">
        <span id="progressPassed" class="pass">0 ‚úì</span>
        <span id="progressLabel" style="color:var(--text2)">0 / 0</span>
        <span id="progressFailed" class="fail">0 ‚úó</span>
      </div>
    </div>
    <div class="panel-footer">
      <div class="run-controls">
        <button class="btn primary" id="btnRunAll" onclick="startRun('auto')">‚ñ∂ –ê–≤—Ç–æ</button>
        <button class="btn" id="btnRunStep" onclick="startRun('step')">‚è≠ –ü–æ—à–∞–≥.</button>
        <button class="btn" id="btnStepNext" onclick="stepNext()" style="display:none">‚Üí –î–∞–ª–µ–µ</button>
        <button class="btn danger small" id="btnStop" onclick="stopRun()" style="display:none">‚ñ†</button>
      </div>
    </div>
  </div>

  <!-- PANEL 2: EDITOR -->
  <div class="panel" id="panel2">
    <div class="panel-header">
      <div class="panel-title">–†–µ–¥–∞–∫—Ç–æ—Ä —Ç–µ—Å—Ç–∞</div>
      <button class="btn small" onclick="newCase()" style="margin-left:auto">Ôºã –ö–µ–π—Å</button>
    </div>
    <div class="panel-body" id="editorBody">
      <div class="empty-state">
        <div class="empty-state-icon">‚úèÔ∏è</div>
        <div class="empty-state-text">–í—ã–±–µ—Ä–∏—Ç–µ –∏–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ —Ç–µ—Å—Ç-–∫–µ–π—Å</div>
      </div>
    </div>
    <div class="editor-actions" id="editorActions" style="display:none">
      <button class="btn primary" onclick="saveCase()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
      <button class="btn" onclick="runSingle()">‚ñ∂ –ó–∞–ø—É—Å—Ç–∏—Ç—å</button>
      <button class="btn danger" onclick="deleteCase()">üóë –£–¥–∞–ª–∏—Ç—å</button>
    </div>
  </div>

  <!-- PANEL 3: RESULTS -->
  <div class="panel" id="panel3">
    <div class="panel-header">
      <div class="panel-title">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã</div>
      <button class="btn small" onclick="clearResults()" style="margin-left:auto">–û—á–∏—Å—Ç–∏—Ç—å</button>
    </div>
    <div class="panel-body" id="resultsList">
      <div class="no-results">
        <div class="no-results-icon">üìã</div>
        <div class="no-results-text">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ—è–≤—è—Ç—Å—è –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞</div>
      </div>
    </div>
  </div>

  <!-- PANEL 4: PREVIEW -->
  <div class="panel" id="panel4">
    <div class="panel-header">
      <div class="panel-title">–ü—Ä–æ—Å–º–æ—Ç—Ä</div>
    </div>
    <div class="preview-tabs">
      <div class="preview-tab active" onclick="switchPreviewTab('graph')">–ì—Ä–∞—Ñ –æ–±—ä–µ–∫—Ç–æ–≤</div>
      <div class="preview-tab" onclick="switchPreviewTab('snapshot')">–°–Ω–∞–ø—à–æ—Ç</div>
      <div class="preview-tab" onclick="switchPreviewTab('request')">–ó–∞–ø—Ä–æ—Å/–û—Ç–≤–µ—Ç</div>
      <div class="preview-tab" onclick="switchPreviewTab('state')">State</div>
      <div class="preview-tab" onclick="switchPreviewTab('log')">–õ–æ–≥</div>
    </div>
    <div class="panel-body" id="previewBody">
      <div class="graph-container" id="graphContainer">
        <div class="empty-state">
          <div class="empty-state-icon">üîó</div>
          <div class="empty-state-text">–ì—Ä–∞—Ñ –æ–±—ä–µ–∫—Ç–æ–≤ –ø–æ—è–≤–∏—Ç—Å—è –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞</div>
        </div>
      </div>
    </div>
  </div>

</div>
<!-- MODAL: recipients -->
<div class="modal-overlay" id="recipientsModal">
  <div class="modal" style="width:520px">
    <div class="modal-title">üìß –ü–æ–ª—É—á–∞—Ç–µ–ª–∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏</div>
    <div id="recipientsTable" style="display:flex;flex-direction:column;gap:4px;max-height:280px;overflow-y:auto;margin-bottom:8px"></div>
    <button class="btn small" onclick="recipientsManager.addRow()">Ôºã –î–æ–±–∞–≤–∏—Ç—å</button>
    <div class="modal-actions">
      <button class="btn" onclick="closeModal('recipientsModal')">–û—Ç–º–µ–Ω–∞</button>
      <button class="btn primary" onclick="recipientsManager.save()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
    </div>
  </div>
</div>
<!-- MODAL: new suite -->
<div class="modal-overlay" id="suiteModal">
  <div class="modal">
    <div class="modal-title">–ù–æ–≤—ã–π –Ω–∞–±–æ—Ä —Ç–µ—Å—Ç–æ–≤</div>
    <div class="field-group">
      <div class="field-label">–ù–∞–∑–≤–∞–Ω–∏–µ</div>
      <input class="input" id="suiteModalName" placeholder="–ú–µ–¥–∏—Ü–∏–Ω–∞: —Ñ–ª–æ—É –≤—Ä–∞—á–∞">
    </div>
    <div class="field-group">
      <div class="field-label">–î–æ–º–µ–Ω</div>
      <select class="select" id="suiteModalDomain">
        <option value="medical">medical</option>
        <option value="taxi">taxi</option>
        <option value="smoke">smoke</option>
      </select>
    </div>
    <div class="field-group">
      <div class="field-label">–û–ø–∏—Å–∞–Ω–∏–µ</div>
      <textarea class="textarea" id="suiteModalDesc" style="min-height:60px" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ –Ω–∞–±–æ—Ä–∞..."></textarea>
    </div>
    <div class="modal-actions">
      <button class="btn" onclick="closeModal('suiteModal')">–û—Ç–º–µ–Ω–∞</button>
      <button class="btn primary" onclick="createSuite()">–°–æ–∑–¥–∞—Ç—å</button>
    </div>
  </div>
</div>

<!-- TOAST -->
<div class="toast-container" id="toastContainer"></div>

<!-- MODAL: recipients -->
<div class="modal-overlay" id="recipientsModal">
  <div class="modal" style="width:520px">
    <div class="modal-title">üìß –ü–æ–ª—É—á–∞—Ç–µ–ª–∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏</div>
    <div id="recipientsTable" style="display:flex;flex-direction:column;gap:4px;max-height:280px;overflow-y:auto;margin-bottom:8px"></div>
    <button class="btn small" onclick="recipientsManager.addRow()">Ôºã –î–æ–±–∞–≤–∏—Ç—å</button>
    <div class="modal-actions">
      <button class="btn" onclick="closeModal('recipientsModal')">–û—Ç–º–µ–Ω–∞</button>
      <button class="btn primary" onclick="recipientsManager.save()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
    </div>
  </div>
</div>

<script src="frontend/app.js"></script>
</html>
