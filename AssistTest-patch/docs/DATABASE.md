# База данных — API Test System

## Миграции

Применяются в порядке номера файла:

```bash
mysql -u user -p db_name < database/migrations/001_api_test_initial.sql
```

## Таблицы

| Таблица | Описание |
|---|---|
| `api_test_suite` | Наборы тестов (суиты) |
| `api_test_case` | Тест-кейсы с параметрами и валидациями |
| `api_test_run` | Запуски тестов |
| `api_test_result` | Результаты выполнения каждого шага |

## SQL-шаблоны

Миграция регистрирует шаблоны `101–112` в таблице `sql_template` (используются через `/query/template/{id}`).

| ID | Назначение |
|---|---|
| 101 | get_suites — список суитов |
| 102 | get_cases — кейсы суита |
| 103 | get_case — один кейс |
| 104 | save_case — создать/обновить кейс |
| 105 | delete_case — удалить кейс |
| 106 | save_suite — создать/обновить суит |
| 107 | start_run — начать запуск |
| 108 | finish_run — завершить запуск |
| 109 | save_result — сохранить результат шага |
| 110 | get_runs — история запусков |
| 111 | get_run_results — результаты запуска |
| 112 | reorder_case — изменить порядок кейса |

## Соглашения

- `snake_case` для всех имён
- `id_entity` — формат первичных ключей
- `create_datetime` / `create_user` — стандартные поля аудита
- Переменные в SQL-шаблонах: `{{var}}`
- Переменные в URL/params UI: `<var>` (передаются через state)
